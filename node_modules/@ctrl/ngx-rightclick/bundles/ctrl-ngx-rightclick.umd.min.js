!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/cdk/overlay"),require("@angular/cdk/portal"),require("@angular/core"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@ctrl/ngx-rightclick",["exports","@angular/cdk/overlay","@angular/cdk/portal","@angular/core","rxjs","rxjs/operators"],t):t((e.ctrl=e.ctrl||{},e.ctrl["ngx-rightclick"]={}),e.ng.cdk.overlay,e.ng.cdk.portal,e.ng.core,e.rxjs,e.rxjs.operators)}(this,function(e,t,g,d,f,n){"use strict";var x=function(){return(x=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};var o=function a(e,t){this.menu=e,this.context=t},M=function(){function e(e,t,n){this._activeContextMenu=e,this._parentInjector=t,this.context=n,this._menuContext=new o(e,n)}return e.prototype.get=function(e,t,n){return e===o?this._menuContext:this._parentInjector.get(e,t,n)},e}(),i=function(){function e(e,t,n){this.overlay=e,this.scrollStrategy=t,this._injector=n,this.menus=[],this.id=0}return e.prototype.show=function(e,t,n,o,i,r,s){var u;void 0===r&&(r=!1),r?(this.closeAll(undefined,s),u=e.target):(this.closeAll(),u={getBoundingClientRect:function(){return{bottom:e.clientY,height:0,left:e.clientX,right:e.clientX,top:e.clientY,width:0}}});var c=new d.ElementRef(u),a=this.overlay.position().flexibleConnectedTo(c).withFlexibleDimensions(!1);r?a.withPositions([{originX:"end",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"end",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"start",overlayY:"bottom"},{originX:"start",originY:"bottom",overlayX:"end",overlayY:"bottom"}]):a.withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"end",overlayY:"top"},{originX:"end",originY:"center",overlayX:"start",overlayY:"center"},{originX:"start",originY:"center",overlayX:"end",overlayY:"center"}]);var l={submenu:r,id:this.id++,isMenuHovered:new f.BehaviorSubject(!1),isTriggerHovered:new f.BehaviorSubject(!1)},p=new M(l,this._injector,n),h=new g.ComponentPortal(t,undefined,p),m=this.overlay.create({positionStrategy:a,panelClass:"ngx-contextmenu",scrollStrategy:this.scrollStrategy.close()}),v=m.attach(h),y=x({overlayRef:m,component:v},l,{menuClose:o,menuAction:i});return this.menus.push(y),y},e.prototype.getCurrentLevel=function(){return this.menus.length},e.prototype.closeAll=function(e,t){void 0===t&&(t=0);for(var n=t;n<this.menus.length;n++){var o=this.menus[n];this.destroyMenu(o,e)}this.menus.splice(t,this.menus.length)},e.prototype.destroyMenu=function(e,t){e.component.instance._state="exit",e.component.instance.lazy?e.component.instance._animationDone.pipe(n.filter(function(e){return"exit"===e.toState}),n.take(1)).subscribe(function(){e.overlayRef.detach(),e.overlayRef.dispose()}):(e.overlayRef.detach(),e.overlayRef.dispose()),t&&e.menuAction.next(t),e.menuClose.next()},e.prototype.close=function(e,t,n){this.destroyMenu(e,n),this.menus.splice(t,1)},e.prototype.checkOutsideClick=function(e){var t,n;try{for(var o=function r(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}(this.menus),i=o.next();!i.done;i=o.next()){if(i.value.component.location.nativeElement.contains(e.target))return e.preventDefault(),void e.stopPropagation()}}catch(s){t={error:s}}finally{try{i&&!i.done&&(n=o["return"])&&n.call(o)}finally{if(t)throw t.error}}this.closeAll()},e.prototype.closeSubMenu=function(t){var e=this.menus.findIndex(function(e){return e.id===t});if(-1!==e&&e===this.menus.length-1){var n=this.menus[e];if(!n.isMenuHovered.getValue()&&!n.isTriggerHovered.getValue())for(var o=this.menus.length-1;1<=o;o--){var i=this.menus[o];if(i.isMenuHovered.getValue()||i.isTriggerHovered.getValue())return;this.close(i,o)}}},e.decorators=[{type:d.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:t.Overlay},{type:t.ScrollStrategyOptions},{type:d.Injector}]},e.ngInjectableDef=d.defineInjectable({factory:function(){return new e(d.inject(t.Overlay),d.inject(t.ScrollStrategyOptions),d.inject(d.INJECTOR))},token:e,providedIn:"root"}),e}(),r=function(){function e(e){this.contextMenuService=e,this.holdToDisplay=1e3,this.menuAction=new d.EventEmitter,this.menuClose=new d.EventEmitter,this.visible=!1}return e.prototype.handleMenu=function(e){e.preventDefault(),this.menu=this.contextMenuService.show(e,this.contextMenuTrigger,this.menuContext,this.menuClose,this.menuAction),this.visible=!0},e.prototype.handleMouseDown=function(e){var t=this;0<=this.holdToDisplay&&(e.stopPropagation(),e.clientY=e.touches[0].clientY,e.clientX=e.touches[0].clientX,this.mouseDownTimeoutId=setTimeout(function(){return t.handleMenu(e)},this.holdToDisplay))},e.prototype.handleMouseUp=function(){clearTimeout(this.mouseDownTimeoutId)},e.prototype.ngOnInit=function(){var e=this;this.sub=this.menuClose.subscribe(function(){return e.visible=!1})},e.prototype.ngOnDestroy=function(){this.sub.unsubscribe()},e.decorators=[{type:d.Directive,args:[{selector:"[contextMenuTrigger]",exportAs:"contextMenuTrigger"}]}],e.ctorParameters=function(){return[{type:i}]},e.propDecorators={contextMenuTrigger:[{type:d.Input}],menuContext:[{type:d.Input}],holdToDisplay:[{type:d.Input}],menuAction:[{type:d.Output}],menuClose:[{type:d.Output}],handleMenu:[{type:d.HostListener,args:["contextmenu",["$event"]]}],handleMouseDown:[{type:d.HostListener,args:["touchstart",["$event"]]}],handleMouseUp:[{type:d.HostListener,args:["touchend"]}]},e}(),s=function(){function e(e){var t=this;this.contextMenuService=e,this.hoverDelay=500,this.openDelay=200,this.menuAction=new d.EventEmitter,this.menuClose=new d.EventEmitter,this.visible=!1,this.level=1,setTimeout(function(){return t.level=t.contextMenuService.getCurrentLevel()})}return e.prototype.handleSubMenuClick=function(e){event.preventDefault(),event.stopPropagation(),clearTimeout(this.opentimer),clearTimeout(this.closetimer),this.menu=this.contextMenuService.show(e,this.contextSubmenuTrigger,this.menuContext,this.menuClose,this.menuAction,!0,this.level),this.visible=!0},e.prototype.handleSubMenuEnter=function(e){var t=this;this.menu&&this.menu.isTriggerHovered.next(!0),clearTimeout(this.closetimer),this.opentimer=setTimeout(function(){t.menu=t.contextMenuService.show(e,t.contextSubmenuTrigger,t.menuContext,t.menuClose,t.menuAction,!0,t.level),t.visible=!0,t.opentimer=null},this.openDelay)},e.prototype.handleSubMenuExit=function(){var e=this;clearTimeout(this.opentimer),this.menu&&this.menu.isTriggerHovered.next(!1),this.closetimer=setTimeout(function(){e.menu&&(e.menu.isTriggerHovered.next(!1),e.contextMenuService.closeSubMenu(e.menu.id),e.menu=undefined),e.visible=!1},this.hoverDelay)},e.prototype.ngOnDestroy=function(){clearTimeout(this.opentimer),clearTimeout(this.closetimer)},e.decorators=[{type:d.Directive,args:[{selector:"[contextSubmenuTrigger]"}]}],e.ctorParameters=function(){return[{type:i}]},e.propDecorators={hoverDelay:[{type:d.Input}],openDelay:[{type:d.Input}],contextSubmenuTrigger:[{type:d.Input}],menuContext:[{type:d.Input}],menuAction:[{type:d.Output}],menuClose:[{type:d.Output}],handleSubMenuClick:[{type:d.HostListener,args:["click",["$event","true"]]}],handleSubMenuEnter:[{type:d.HostListener,args:["mouseover",["$event"]]}],handleSubMenuExit:[{type:d.HostListener,args:["mouseout",["$event"]]}]},e}(),u=function(){function e(e,t){this.menuPackage=e,this.contextMenuService=t,this._state="enter",this._animationDone=new f.Subject,this.lazy=!0}return e.prototype.handleMouseover=function(){this.menuPackage.menu.submenu&&(this.menuPackage.menu.isMenuHovered.next(!0),clearTimeout(this.closetimer))},e.prototype.handleMouseleave=function(){var e=this;this.menuPackage.menu.submenu&&(this.menuPackage.menu.isMenuHovered.next(!1),this.closetimer=setTimeout(function(){e.contextMenuService.closeSubMenu(e.menuPackage.menu.id)},500))},e.prototype.handleWindowClick=function(e){this.contextMenuService.checkOutsideClick(e)},e.prototype._onAnimationDone=function(e){this._animationDone.next(e)},e.decorators=[{type:d.Component,args:[{selector:"app-menu",template:""}]}],e.ctorParameters=function(){return[{type:o},{type:i}]},e.propDecorators={handleMouseover:[{type:d.HostListener,args:["mouseover"]}],handleMouseleave:[{type:d.HostListener,args:["mouseleave"]}],handleWindowClick:[{type:d.HostListener,args:["document:click",["$event"]]}]},e}(),c=function(){function e(){}return e.decorators=[{type:d.NgModule,args:[{declarations:[r,s,u],exports:[r,s],imports:[g.PortalModule,t.OverlayModule]}]}],e}();e.ContextMenuModule=c,e.MenuPackage=o,e.MenuInjector=M,e.MenuComponent=u,e.ContextSubmenuTriggerDirective=s,e.ContextMenuTriggerDirective=r,e.ContextMenuService=i,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ctrl-ngx-rightclick.umd.min.js.map